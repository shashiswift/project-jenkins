'use strict';$(document).ready(function(){function k(d){var a=$(".search").val()?btoa($(".search").val()):"NULL";$.ajax({url:f+"Operation/operation_listing/"+a+"/"+d,type:"get",dataType:"json",success:function(b){$("#operation_pagination").html(b.pagination);b=b.result;$("#operation_list").empty();$("#operation_list").html(b)}})}var f=$("body").attr("data-url"),l=$('meta[name="_tokken"]').attr("content"),m=0;k(m);$("#operation_pagination").on("click","a",function(d){d.preventDefault();m=$(this).attr("data-ci-pagination-page");
k(m)});$(document).on("click",".search_listing",function(){k(0)});$(document).on("click",".clear_listing",function(){$(".search").val("");k(0)});var n=1;$(document).on("submit",".add_operation",function(d){d.preventDefault();var a=$(this);1==n?(n++,$.ajax({async:!0,url:f+"Operation/add",type:"post",data:$(this).serialize(),success:function(b){$(".error_add").html("");b=$.parseJSON(b);0<b.status?(k(0),iziToast.success({title:"success",message:b.msg,position:"topRight"}),$('#add_operation button[data-dismiss="modal"]').click(),
a.trigger("reset")):iziToast.warning({title:"ERROR",message:b.msg,position:"topRight"});n=1;b.errors?$(".error_add").html(b.errors):$(".error_add").html("")},error:function(b){console.log(b);n=1}})):iziToast.warning({title:"ERROR",message:"WAIT FOR RESPONSE",position:"topRight"})});$(document).on("click",".edit",function(){var d=$(this).data("id");$.ajax({async:!0,url:f+"Operation/operation_get",type:"post",data:{id:d,_tokken:l},success:function(a){if(a=$.parseJSON(a))$('.edit_operation input[name="function_name"]').val(a.function_name),
$('.edit_operation input[name="controller_name"]').val(a.controller_name),$('.edit_operation input[name="alias"]').val(a.alias),$('.edit_operation input[name="function_id"]').val(a.function_id)},error:function(a){console.log(a)}})});$(document).on("submit",".edit_operation",function(d){d.preventDefault();$(this);$.ajax({async:!0,url:f+"Operation/edit",type:"post",data:$(this).serialize(),success:function(a){$(".role_edit_errors").html("");a=$.parseJSON(a);0<a.status?(k(m),iziToast.success({title:"success",
message:a.msg,position:"topRight"}),$('.edit_operation button[data-dismiss="modal"]').click()):iziToast.warning({title:"ERROR",message:a.msg,position:"topRight"});a.errors?$(".role_edit_errors").html(a.errors):$(".role_edit_errors").html("")},error:function(a){console.log(a)}})});$(document).on("click",".permission",function(){function d(e){$.ajax({url:f+"Roles/fetch_functions",type:"post",data:{controller_name:e,_tokken:l},success:function(g){g=$.parseJSON(g);var c="";$.each(g,function(p,h){c=b?
inArray(h.function_id,b)?c+('<input checked  type="checkbox" name=function_id[]  value="'+h.function_id+'">'+h.alias):c+('<input type="checkbox" name=function_id[]  value="'+h.function_id+'">'+h.alias):c+('<input type="checkbox" name=function_id[]  value="'+h.function_id+'">'+h.alias)});$("#"+e).after('<div class="accordion_body" style="display: none">'+c+"</div>")}})}var a=$(this).data("id");$("#role_permission input[name='role_id']").val(a);var b=function(e){var g;$.ajax({url:f+"Roles/fetch_permission",
type:"post",async:!1,data:{role_id:e,_tokken:l},success:function(c){g=0!=c?$.parseJSON(c):!1}});return g}(a);$.ajax({url:f+"Roles/fetch_controller",type:"post",data:{_tokken:l},success:function(e){e=$.parseJSON(e);$(".accordion_container").empty();$.each(e,function(g,c){$(".accordion_container").append("<div class=accordion_head id="+c.controller_name+">"+c.controller_name+"<span class=plusminus>+</span></div>");d(c.controller_name)})}})})});