'use strict';$(document).ready(function(){function d(b){var c=$(".applicant_id").val()?$(".applicant_id").val():"NULL",a=$(".manufacture_id").val()?$(".manufacture_id").val():"NULL",e=$(".factory_id").val()?$(".factory_id").val():"NULL",m=$(".lab_name").val()?$(".lab_name").val():"NULL",f=$(".start_Date").val()?$(".start_Date").val():"NULL",p=$(".end_Date").val()?$(".end_Date").val():"NULL",q=$(".destinaition").val()?$(".destinaition").val():"NULL",r=$(".application").val()?$(".application").val():
"NULL",t=$(".search").val()?btoa($(".search").val()):"NULL";$.ajax({url:k+"Gmark/gmark_listing/"+c+"/"+a+"/"+e+"/"+m+"/"+f+"/"+p+"/"+q+"/"+r+"/"+t+"/"+b,type:"get",dataType:"json",success:function(n){$("#gmark_pagination").html(n.pagination);n=n.result;$("#gmark_list").empty();$("#gmark_list").html(n)}})}var g=$('meta[name="_tokken"]').attr("content"),k=$("body").attr("data-url"),h=0;$("#gmark_pagination").on("click","a",function(b){b.preventDefault();h=$(this).attr("data-ci-pagination-page");d(h)});
d(0);$(document).on("click",".submit_listing",function(){h=0;d(h)});$(document).on("click",".clear_listing",function(){$("input").val("");$("#listing_filter").trigger("reset");h=0;d(h)});$(document).on("keyup",".focusout_autosuggestion",function(){var b=$(this).val(),c=$(this);b?$.ajax({url:k+"Gmark/search",type:"POST",data:{key:b,_tokken:g,table:"gmark_customers",coloum:"entity_name",select:"customers_id,entity_name"},success:function(a){a=$.parseJSON(a);var e="";a?($.each(a,function(m,f){e+='<li class="list-group-item list-group-item-action li-state" data-id="'+
f.customers_id+'">'+f.entity_name+"</li>"}),e+=""):(e+='<li class="list-group-item list-group-item-action li-state" data-id="NULL">NO RECORD FOUND</li>',$(".applicant_id").val("NULL"));c.siblings("div.drop_down_ul.posiotio").children("ul.itemList1").html(e).fadeIn()},error:function(a){console.log(a)}}):c.siblings('input[type="hidden"]').val("NULL")});$(".itemList1").on("click","li",function(){$(this).parents().siblings('input[type="text"]').val($(this).text());$(this).parents().siblings('input[type="hidden"]').val($(this).data("id"));
$(".itemList1").fadeOut()});$(".focusout_autosuggestion").focusout(function(){$(this).siblings("div.drop_down_ul.posiotio").children("ul.itemList1").fadeOut()});var l=1;$("form#document_upload_request").submit(function(b){b.preventDefault();var c=$(this);b=new FormData(this);2>l?(l++,$(".myprogress").text("0%"),$(".myprogress").css("width","0%"),$.ajax({url:k+"Gmark/Upload_document",type:"POST",processData:!1,contentType:!1,data:b,xhr:function(){var a=new window.XMLHttpRequest;a.upload.addEventListener("progress",
function(e){e.lengthComputable&&(e=e.loaded/e.total,e=parseInt(100*e),$(".myprogress").text(e-20+"%"),$(".myprogress").css("width",e-20+"%"))},!1);return a},success:function(a){a=$.parseJSON(a);0<a.status?($(".myprogress").text("100%"),$(".myprogress").css("width","100%"),l=1,iziToast.success({title:"success",message:a.msg,position:"topRight"}),setTimeout(function(){c.trigger("reset");$("#document_list").modal("hide");d(h);$(".myprogress").text("0%");$(".myprogress").css("width","0%")},500)):($(".myprogress").text("0%"),
$(".myprogress").css("width","0%"),l=1,iziToast.warning({title:"ERROR",message:a.msg,position:"topRight"}));a.errors?$(".error_document_upload").html(a.errors):$(".error_document_upload").html("")},error:function(a){l=1;console.log(a)}})):iziToast.warning({title:"WAIT",message:"WAIT FOR UPLOAD",position:"topRight"})});$(document).on("click",".doc_upload",function(){var b=$(this).data("id");$(".doc_upload_request").val(b)});$(document).on("click",".delete_doc",function(){$(this).hide();var b=$(this).data("id"),
c=$(this).data("reg"),a=$(this).data("table"),e=$(this).data("primary"),m=$(this).data("delte");$.ajax({url:k+"Gmark/delte_document",type:"POST",data:{_tokken:g,coloum:e,table:a,id:b,delete:m},success:function(f){f=$.parseJSON(f);0<f.status?(iziToast.success({title:"success",message:f.msg,position:"topRight"}),view_document(c)):iziToast.warning({title:"success",message:f.msg,position:"topRight"});f.errors?$("#errors_delete").html(f.errors):$("#errors_delete").html("")},error:function(f){console.log(f)}})});
$(document).on("click",".view_rfc_src",function(){var b=$(this).data("text"),c=$(this).data("release");$("#view_rfc_pdf").html('<iframe height="400px" width="100%" src="'+b+'" frameborder="0"></iframe><div class="row"><div class="col-sm-12 text-right"><a data-text="'+c+'" href="javascript:void(0);" class="btn btn-sm btn-primary release_rfc_pdf">RELEASE</a></div></div>')});$(document).on("click",".approved",function(){var b=$(this).data("text");swal({title:"Are you sure?",text:"Once APPROVED, you will not be able to REJECT this REQUEST!",
icon:"warning",buttons:!0,dangerMode:!0}).then(c=>{c?$.get(b,function(a){a=$.parseJSON(a);0<a.status?(swal("Poof! Your REQUEST has been APPROVED!",{icon:"success"}),d(h),iziToast.success({title:"Success",message:a.msg,position:"topRight"})):(swal("ALREADY",a.msg,"error"),iziToast.warning({title:"Warning",message:a.msg,position:"topRight"}))}):swal("Your REQUEST is NOT APPROVED!")})});$(document).on("click",".release_rfc_pdf",function(){var b=$(this).data("text");swal({title:"Are you sure?",text:"Once RELEASE, you will not be able to EDIT this RFC file!",
icon:"warning",buttons:!0,dangerMode:!0}).then(c=>{c?$.get(b,function(a){a=$.parseJSON(a);swal("Poof! Your RFC file has been RELEASE!",{icon:"success"});0<a.status?(d(h),$("#view_Rfc").modal("hide"),iziToast.success({title:"Success",message:a.msg,position:"topRight"})):iziToast.warning({title:"Warning",message:a.msg,position:"topRight"})}):swal("Your RFC file is EDITABLE!")})});document_list();$(document).on("click",".log",function(){var b=$(this).data("id");$.ajax({url:k+"Gmark/log",data:{id:b,_tokken:g},
type:"POST",success:function(c){c=$.parseJSON(c);$("#history_view").html(c)},error:function(c){console.log(c)}})})});var _tokken=$('meta[name="_tokken"]').attr("content"),base_url=$("body").attr("data-url");
function document_list(){$.ajax({url:base_url+"Gmark/document_listing",type:"POST",data:{_tokken},success:function(d){(d=$.parseJSON(d))&&$.each(d,function(g,k){$("#document_other").append($("<option>",{value:k.document_id,text:k.document_name}))})},error:function(d){console.log(d)}});$(document).on("click",".doc_view",function(){$("#view_document_uploaded").html("");var d=$(this).data("id");view_document(d)})}
function view_document(d){$.ajax({url:base_url+"Gmark/view_document_listing",type:"POST",data:{id:d,_tokken},success:function(g){g=$.parseJSON(g);0<g.status?iziToast.success({title:"Success",message:g.msg,position:"topRight"}):iziToast.warning({title:"Warning",message:g.msg,position:"topRight"});g.html&&$("#view_document_uploaded").html(g.html)},error:function(g){console.log(g)}})};